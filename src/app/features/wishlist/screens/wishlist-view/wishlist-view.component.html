<div class="main-container">
  <div *ngIf="wishList$ | async as wishList; else loading">
    <div *ngIf="wishList.length > 0; else emptyState">
      <div
        fxLayout="row"
        fxLayoutAlign="space-between center"
        class="top-section"
      >
        <h1 class="page-header">Your wish list</h1>

        <button
          *ngIf="wishList.length > 0"
          (click)="showAddItemDialog()"
          mat-mini-fab
          color="primary"
          aria-label="Add new item"
        >
          <mat-icon>add</mat-icon>
        </button>
      </div>

      <div class="cards-container">
        <mat-card
          fxLayout="column"
          class="card"
          *ngFor="let listItem of wishList"
        >
          <div fxFill fxLayout="column" fxLayoutGap="16px">
            <h1 class="card__title">{{ listItem.name }}</h1>

            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="16px">
              <mat-icon class="details-icon">link</mat-icon>
              <a
                *ngIf="listItem.url"
                [href]="listItem.url"
                target="_blank"
                rel="noopener noreferrer"
              >
                Link to shop
              </a>

              <span *ngIf="!listItem.url">
                <i>No link provided</i>
              </span>
            </div>

            <div
              fxHide.lt-sm="true"
              fxLayout="row"
              fxLayoutAlign="start center"
              fxLayoutGap="16px"
            >
              <mat-icon class="details-icon">note</mat-icon>
              <span *ngIf="listItem.note">{{ listItem.note }}</span>
              <span *ngIf="!listItem.note"><i>No note provided</i></span>
            </div>

            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="16px">
              <mat-icon class="details-icon">update</mat-icon>
              <span>
                Last updated on
                {{ listItem.updatedAt.toDate() | date: 'longDate' }}
              </span>
            </div>

            <div
              class="card__actions"
              fxFlex
              fxLayout="row"
              fxLayoutAlign="end end"
              fxLayoutGap="8px"
            >
              <button
                (click)="handleDeleteItem(listItem.id)"
                mat-stroked-button
                color="warn"
              >
                Delete
              </button>
              <button
                (click)="showEditItemDialog(listItem)"
                mat-stroked-button
                color="primary"
              >
                Edit
              </button>
            </div>
          </div>
        </mat-card>
      </div>
    </div>
  </div>
</div>

<ng-template #loading>
  <div fxLayoutAlign="center">
    <mat-spinner></mat-spinner>
  </div>
</ng-template>

<ng-template #emptyState>
  <div class="empty-state" fxLayout="column" fxLayoutAlign="start center">
    <img
      class="empty-state__image"
      src="/assets/images/undraw_santa_visit_loux.svg"
      alt="No Data"
    />

    <h1 class="mat-title empty-state__heading">
      Your wishlist is empty
    </h1>

    <button (click)="showAddItemDialog()" mat-raised-button color="primary">
      Add first item
    </button>
  </div>
</ng-template>
